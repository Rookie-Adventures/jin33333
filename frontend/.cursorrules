本规范基于 全局开发规范，针对前端项目做进一步细化。

# 前端项目规范

## 目录结构

```plaintext
frontend/
src/
├── components/        # 组件目录
│   ├── common/       # 通用组件
│   └── business/     # 业务组件
│       ├── Chat/
│       └── Profile/
├── pages/            # 页面组件
│   ├── Home/         # 首页
│   ├── Login/        # 登录页
│   └── Dashboard/    # 仪表盘
├── router/           # 路由配置
├── store/            # 状态管理
├── utils/            # 工具函数
├── hooks/            # 自定义钩子
│   ├── auth/         # 鉴权相关
│   ├── data/         # 数据管理相关
│   └── ui/           # UI 交互相关
├── theme/            # 主题配置
│   └── index.ts      # 主题入口文件
├── types/            # 类型定义
│   ├── theme.ts      # 与主题相关的类型
│   ├── api.ts        # API 类型定义
│   ├── components.ts # 通用组件类型
│   └── index.ts      # 汇总导出
└── assets/           # 静态资源
    ├── images/       # 图片资源
    ├── icons/        # 图标资源
    └── fonts/        # 字体资源
```

---

## 技术栈规范

### 技术选型
- **框架**: React@18.2.0
- **语言**: TypeScript@5.3.3
- **样式库**: MUI@5.16.9
- **状态管理**:
  - 全局状态: Redux Toolkit
  - 局部状态: Zustand

---

## UI/UX规范

### 组件设计
- 组件应遵循单一职责原则，避免过于复杂。
- 通用组件具备高复用性，业务组件满足特定场景。

### 响应式布局
- 使用 Flexbox 和 Grid 布局，确保良好的适配性。：

  ```

### 主题与样式
- 使用 MUI 主题系统，统一颜色、字体和间距。
- 支持动态主题切换，所有组件样式应与主题保持一致。

---

## React开发规范

### 组件拆分
- 按功能拆分组件，避免单一组件过于庞大。
- 建议采用"容器组件"和"展示组件"的模式，分离逻辑和视图。

### Props 和 State
- **Props**：
  - 必须定义类型，使用 TypeScript 进行类型检查。
- **State**：
  - 尽量简化，避免不必要的状态。

### Hooks
- 自定义 Hooks 必须以 `use` 开头，遵循命名规则。
- 避免在条件语句中调用 Hooks，确保调用顺序一致。

---

## 状态管理规范

### Redux Toolkit
- 使用 `createSlice` 创建切片，按功能模块拆分。
- 按需使用 `RTK Query` 处理异步逻辑。

### Zustand
- 适用于局部状态管理，避免滥用。
- 使用 `createStore` 创建 store，确保状态的可追踪性。

---

## 路由管理规范

### 路由结构设计
- 使用 React Router 管理路由，支持懒加载，优化首屏加载时间。
- 每个页面的嵌套路由可以单独管理：

  ```typescript
  pages/
  ├── Home/
  │   ├── index.tsx
  │   ├── Home.test.tsx
  │   └── routes.ts
  ```

### 路由权限
- 对需要鉴权的路由进行保护，确保用户权限的正确性。

---

## 性能优化

### 加载优化
- 使用代码分割和懒加载，减少初始加载时间。
- 图片资源采用懒加载技术，提升页面加载速度。

### 渲染优化
- 使用 `React.memo` 和 `useMemo` 避免不必要的重渲染。
- 长列表推荐使用 `react-window` 或 `react-virtualized`。

---

## 安全机制

### XSS 防护
- 对用户输入进行严格的验证和过滤。

### CSRF 防护
- 使用 CSRF Token 验证请求合法性。

### 敏感信息
- 不在前端暴露敏感信息，如 API 密钥等。

---

## 错误处理规范

### 错误类型系统
- 使用 TypeScript 枚举定义错误类型：
  ```typescript
  enum HttpErrorType {
    NETWORK = 'NETWORK',    // 网络错误
    TIMEOUT = 'TIMEOUT',    // 超时错误
    AUTH = 'AUTH',         // 认证错误
    SERVER = 'SERVER',     // 服务器错误
    CLIENT = 'CLIENT',     // 客户端错误
    CANCEL = 'CANCEL',     // 请求取消
    UNKNOWN = 'UNKNOWN',   // 未知错误
    REACT_ERROR = 'REACT_ERROR', // React组件错误
    VALIDATION = 'VALIDATION',   // 验证错误
    BUSINESS = 'BUSINESS'       // 业务错误
  }
  ```

### 错误处理机制
1. **错误边界组件**
   - 使用 React ErrorBoundary 捕获渲染错误
   - 支持自定义 fallback UI
   - 集成错误日志记录

2. **HTTP 错误处理**
   - 使用工厂模式创建标准化的错误对象
   - 支持错误恢复策略
   - 包含重试机制
   ```typescript
   interface HttpError extends Error {
     type: HttpErrorType;
     status?: number;
     code?: string | number;
     data?: unknown;
     trace?: ErrorTrace;
     recoverable?: boolean;
     retryCount?: number;
   }
   ```

3. **错误预防**
   - 请求前预检查机制
   - 请求数据验证
   - 敏感数据检查
   - 请求缓存管理

4. **错误恢复策略**
   - 网络错误：自动重试，最多3次
   - 超时错误：延长超时时间重试
   - 认证错误：自动刷新 token
   - 服务器错误：对非500错误进行重试

5. **错误通知系统**
   - 使用 Material-UI Snackbar 组件
   - 不同错误类型的差异化展示
   - 支持错误恢复操作
   - 自动隐藏非关键错误

### 错误日志
- 记录错误类型、时间戳和上下文信息
- 支持错误追踪和定位
- 包含错误发生时的请求信息

### 开发建议
1. **错误处理最佳实践**
   - 使用 try-catch 包装异步操作
   - 避免吞掉错误，确保错误可追踪
   - 提供用户友好的错误提示

2. **错误预防建议**
   - 请求前进行数据验证
   - 使用 TypeScript 类型检查
   - 实现请求超时控制

3. **错误恢复建议**
   - 实现幂等性操作
   - 保存用户操作状态
   - 提供手动重试选项

### 待优化项
1. **错误分析**
   - 错误聚合和分类
   - 错误趋势分析
   - 错误报警机制

2. **性能监控**
   - 请求耗时统计
   - 错误率统计
   - 性能指标收集

3. **开发体验**
   - 开发环境详细错误信息
   - 错误复现辅助信息

---

## 测试规范

### 组件测试
- - 使用 Vitest 和 React Testing Library 进行单元测试。

- 建议按模块集中管理测试文件：
  ```plaintext
  src/
  ├── __tests__/         # 测试目录
  │   ├── Home.test.tsx  # 首页测试
  │   ├── utils.test.ts  # 工具函数测试
  ```

### 覆盖率要求
- 组件测试覆盖率应达到 80% 以上，确保核心逻辑的测试完整性。

---

## 版本控制规范

### 提交信息
- 使用规范化的提交信息格式，例如：
  ```plaintext
  feat: 添加用户登录功能
  fix: 修复登录接口错误
  docs: 更新项目文档
  ```

### 分支命名
- 采用 `feature/xxx` 和 `bugfix/xxx` 命名规则，保持分支清晰。

---